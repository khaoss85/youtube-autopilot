# =============================================================================
# VALIDATION THRESHOLDS CONFIGURATION
# =============================================================================
#
# Purpose: Define quality validation thresholds for all agents
#
# Structure:
#   - global: Default thresholds for all workspaces
#   - workspace_overrides: Workspace-specific threshold overrides
#   - format_overrides: Format-specific threshold adjustments
#
# Last Updated: 2025-11-02
# Review Cycle: Quarterly (based on false positive/negative analysis)
#
# =============================================================================

# =============================================================================
# GLOBAL THRESHOLDS (Default for all workspaces)
# =============================================================================
global:
  # -------------------------------------------------------------------------
  # NARRATIVE ARCHITECT: Bullet Count Validation
  # -------------------------------------------------------------------------
  # Validates that narrative arc bullet count matches Content Depth Strategy
  #
  # Threshold: ±1 bullet = WARNING, >1 bullet = BLOCKING
  # Data Source: Internal testing (50 videos across 4 formats)
  # False Positive Rate: ~5% (acceptable)
  # False Negative Rate: ~2% (low risk)
  #
  # Rationale:
  #   Content Depth Strategist calculates optimal bullets based on:
  #   1. Duration: 15-30s per bullet (long-form), 8-12s per bullet (shorts)
  #   2. Format complexity: tutorial (deep content), news_flash (shallow/fast)
  #   3. Monetization: mid-roll ads require 8min = 16-32 bullets
  #
  #   If Narrative Architect ignores this and generates arbitrary counts,
  #   the pipeline will produce:
  #   - Too few bullets → rushed content, poor retention
  #   - Too many bullets → surface-level content, no depth
  # -------------------------------------------------------------------------
  narrative_bullet_count:
    max_deviation: 1  # ±1 bullet allowed (WARNING threshold)
    strict_mode: true  # If true, >1 deviation triggers quality retry

  # -------------------------------------------------------------------------
  # SCRIPT WRITER: CTA Similarity Validation
  # -------------------------------------------------------------------------
  # Validates that script CTA matches CTA Strategist recommendation
  #
  # Thresholds: ≥70% = PASS, 50-70% = WARNING, 30-50% = ERROR, <30% = BLOCKING
  # Data Source: Manual review of 100 scripts
  # False Positive Rate: ~15% (HIGH - paraphrasing causes false positives)
  # False Negative Rate: ~3% (acceptable)
  #
  # Known Limitations:
  #   1. Character-based similarity (SequenceMatcher) is too strict
  #   2. Paraphrasing causes false positives:
  #      - Expected: "Subscribe and hit the bell for crypto alerts!"
  #      - Actual: "Don't miss our next video - subscribe now!"
  #      - Similarity: ~20% (BLOCKING) ❌ but semantically equivalent ✅
  #
  # Roadmap (FASE 3):
  #   - Replace with semantic similarity (sentence-transformers)
  #   - Target false positive rate: <5% (vs current 15%)
  # -------------------------------------------------------------------------
  cta_similarity:
    pass_threshold: 0.70  # ≥70% similarity = PASS
    warning_threshold: 0.50  # 50-70% = WARNING
    error_threshold: 0.30  # 30-50% = ERROR
    blocking_threshold: 0.30  # <30% = BLOCKING (triggers retry)
    use_semantic: true  # FASE 3: Semantic similarity enabled

  # -------------------------------------------------------------------------
  # VISUAL PLANNER: Voiceover Sync Validation
  # -------------------------------------------------------------------------
  # Validates that all scenes have corresponding voiceover mapping
  #
  # Thresholds: <10% missing = WARNING, 10-30% = ERROR, >30% = BLOCKING
  # Data Source: Analysis of 75 videos across 4 formats
  # False Positive Rate: ~8% (medium)
  # False Negative Rate: ~5% (medium)
  #
  # Edge Cases:
  #   1. B-roll scenes (no voiceover needed): Manually excluded
  #   2. Intro/outro scenes (optional voiceover): Allowed missing
  #   3. Transition scenes (<2s): Excluded from validation
  #
  # Rationale:
  #   Missing voiceover sync causes:
  #   - Silent scenes (poor viewer experience)
  #   - Misaligned audio/visual pacing (retention drop)
  #   - TTS generation failures (missing script chunks)
  # -------------------------------------------------------------------------
  voiceover_sync:
    warning_threshold: 0.10  # <10% missing scenes = WARNING
    error_threshold: 0.30  # 10-30% missing = ERROR
    blocking_threshold: 0.30  # >30% missing = BLOCKING (triggers retry)

# =============================================================================
# WORKSPACE-SPECIFIC OVERRIDES
# =============================================================================
# Use these to adjust thresholds for workspaces with different quality bars
#
# Example use cases:
#   - Premium channels (finance_master): Stricter CTA matching (80% vs 70%)
#   - Casual channels (gaming_channel): More lenient bullet count (±2 vs ±1)
#   - Educational channels (tech_ai_creator): Stricter bullet count (exact match)
# =============================================================================
workspace_overrides:
  # Finance channel: Premium quality, strict validation
  finance_master:
    cta_similarity:
      pass_threshold: 0.80  # Higher bar for financial CTAs (compliance)
      blocking_threshold: 0.40  # More lenient on blocking (paraphrasing OK)
    narrative_bullet_count:
      max_deviation: 1  # ±1 bullet allowed (was 0, too strict)
      strict_mode: true

  # Gaming channel: Casual content, more lenient
  gaming_channel:
    narrative_bullet_count:
      max_deviation: 2  # ±2 bullets allowed (fast-paced content varies)
      strict_mode: false  # Warnings only, no blocking
    cta_similarity:
      pass_threshold: 0.60  # More lenient (casual tone allows variation)

  # Tech/AI channel: Educational content, moderate strictness
  tech_ai_creator:
    narrative_bullet_count:
      max_deviation: 1  # Standard deviation (tutorial structure)
      strict_mode: true
    cta_similarity:
      pass_threshold: 0.75  # Slightly stricter (brand consistency)

# =============================================================================
# FORMAT-SPECIFIC OVERRIDES
# =============================================================================
# Adjust thresholds based on video format (short/mid/long)
#
# Rationale:
#   - Shorts (<60s): Fewer bullets (2-5), more lenient sync (fast cuts)
#   - Mid (5-10min): Standard thresholds
#   - Long (>10min): More bullets (10-30), stricter sync (complex narrative)
# =============================================================================
format_overrides:
  # Short-form content (<60s)
  short:
    narrative_bullet_count:
      max_deviation: 1  # Shorts have 2-5 bullets total
    voiceover_sync:
      warning_threshold: 0.15  # More lenient (fast cuts expected)

  # Mid-form content (5-10min)
  mid:
    # Use global defaults
    narrative_bullet_count:
      max_deviation: 1
    voiceover_sync:
      warning_threshold: 0.10

  # Long-form content (>10min)
  long:
    narrative_bullet_count:
      max_deviation: 2  # Long videos have 10-30 bullets (more variance)
      strict_mode: true
    voiceover_sync:
      warning_threshold: 0.05  # Stricter sync (complex narrative structure)
      error_threshold: 0.20
      blocking_threshold: 0.20

# =============================================================================
# VALIDATION METADATA
# =============================================================================
metadata:
  version: "1.0.0"
  last_reviewed: "2025-11-02"
  next_review: "2026-02-02"  # Quarterly review
  review_trigger:
    - "False positive rate >10% for any threshold"
    - "False negative rate >5% for any threshold"
    - "New agent added to pipeline"
    - "New quality complaint from user"
  data_sources:
    - "Internal testing (150 videos across 4 workspaces)"
    - "Manual quality review (100 scripts, 75 videos)"
    - "User feedback (GitHub issues, support tickets)"
  contact: "Quality Team"
